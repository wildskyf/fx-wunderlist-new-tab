!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),(t.wunderlist||(t.wunderlist={})).sdk=e()}}(function(){return function e(t,i,n){function r(o,a){if(!i[o]){if(!t[o]){var c="function"==typeof require&&require;if(!a&&c)return c(o,!0);if(s)return s(o,!0);throw new Error("Cannot find module '"+o+"'")}var u=i[o]={exports:{}};t[o][0].call(u.exports,function(e){var i=t[o][1][e];return r(i?i:e)},u,u.exports,e,t,i,n)}return i[o].exports}for(var s="function"==typeof require&&require,o=0;o<n.length;o++)r(n[o]);return r}({1:[function(e,t,i){(function(i,n){"use strict";var r=i.browser;if(r&&n.MagiConsole)t.exports=n.MagiConsole;else{var s=n.console,o=e("wunderbits.core/public/WBClass"),a=e("wunderbits.core/public/lib/assert"),c=e("wunderbits.core/public/lib/functions"),u=e("wunderbits.core/public/lib/toArray"),l={error:3,warn:4,log:5,info:6,debug:7},d=Object.keys(l),f={blue:"[34m",cyan:"[36m",green:"[32m",grey:"[90m",magenta:"[35m",red:"[31m",white:"[37m",yellow:"[33m"},p="[39m",v={debug:"cyan",error:"red",info:"grey",log:"white",warn:"yellow"};d.forEach(function(e){"function"!=typeof s[e]&&(s[e]=s.log)});var h={constructor:function(e){var t=this;a.string(e,"namespace must be a string");var i=m.namespaces;return i[e]instanceof m?i[e]:(t.namespace=e,i[e]=t,void o.call(t))},shouldRunLevel:function(e){var t=l[m.level],i=l[e];return void 0===t||void 0===i?!0:m.levelOnly?i===t:t>=i},shouldRun:function(e){var t=this,i=m.pattern,n=m.level,r=i&&i.test(t.namespace);return r=r&&(n?t.shouldRunLevel(e):!0),!(!r||!s)},colorizeString:function(e,t){return f[t]+e+p},colorizeNamespace:function(e,t){var i=v[t];return i&&(e=this.colorizeString(e,i)),e},colorizeStrings:function(e,t){var i=this;return t.forEach(function(n,r){"string"==typeof n&&(t[r]=i.colorizeNamespace(n,e))}),t},injectNamespace:function(e,t){var i=this;if(d.indexOf(e)>=0){t=u(t);var n="["+i.namespace.toUpperCase()+"]";"string"==typeof t[0]?t[0]=n+" "+t[0]:t.unshift(n),!r&&i.colorizeStrings(e,t)}return t}};c(s).forEach(function(e){h[e]=function(){var t=this,i=arguments;t.shouldRun(e)&&(i=t.injectNamespace(e,i),s[e].apply(s,i))}});var m=o.extend(h);if(m.release=function(){m.namespaces={}},m.reset=m.off=function(){m.pattern=void 0,m.level=void 0,m.levelOnly=!1},m.setPattern=function(e){a.string(e,"regexPatternString must be a string"),e="*"===e?".?":e,m.pattern=new RegExp(e)},m.setLevel=function(e,t){a.string(e,"logLevel must be a string"),e="*"===e?void 0:e,m.level=e,m.levelOnly=!!t},!r){var g=i.env,b=g.MLOG,y=g.MLEVEL;b&&m.setPattern(b),y&&m.setLevel(y,"true"===g.MLEVELONLY)}m.release(),m.reset(),t.exports=m}}).call(this,e("pBGvAp"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{pBGvAp:2,"wunderbits.core/public/WBClass":5,"wunderbits.core/public/lib/assert":13,"wunderbits.core/public/lib/functions":23,"wunderbits.core/public/lib/toArray":29}],2:[function(e,t,i){function n(){}var r=t.exports={};r.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var i=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),i.length>0)){var n=i.shift();n()}},!0),function(e){i.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=n,r.addListener=n,r.once=n,r.off=n,r.removeListener=n,r.removeAllListeners=n,r.emit=n,r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")}},{}],3:[function(e,t,i){"use strict";var n=e("./WBEventEmitter").extend({mixins:[e("./mixins/WBDestroyableMixin"),e("./mixins/WBUtilsMixin"),e("./mixins/ObservableHashMixin")]});t.exports=n},{"./WBEventEmitter":7,"./mixins/ObservableHashMixin":33,"./mixins/WBDestroyableMixin":35,"./mixins/WBUtilsMixin":38}],4:[function(e,t,i){"use strict";var n=e("./WBSingleton").extend({mixins:[e("./mixins/WBEventsMixin"),e("./mixins/WBBindableMixin"),e("./mixins/WBDestroyableMixin"),e("./mixins/WBUtilsMixin"),e("./mixins/ObservableHashMixin")]});t.exports=n},{"./WBSingleton":10,"./mixins/ObservableHashMixin":33,"./mixins/WBBindableMixin":34,"./mixins/WBDestroyableMixin":35,"./mixins/WBEventsMixin":36,"./mixins/WBUtilsMixin":38}],5:[function(e,t,i){"use strict";function n(e,t){var i=this;e=e||{};var r=e.mixins||[];delete e.mixins;for(var o,a=s(i,e,t);r.length;)o=r.shift(),"function"==typeof o.applyToClass&&o.applyToClass(a);return a.extend=i.extend||n,a}function r(e){var t=this;t.uid=t.uid||c(),t.options=e||t.options,t.augmentProperties(),t.initialize.apply(t,arguments),t.initMixins.apply(t,arguments)}var s=e("./lib/inherits"),o=e("./lib/extend"),a=e("./lib/clone"),c=e("./lib/createUID"),u=e("./lib/fromSuper"),l={initialize:function(){var e=this;return e},initMixins:function(){for(var e,t=this,i=u.concat(t,"initializers");i.length;)e=i.shift(),"function"==typeof e&&e.apply(t,arguments)},augmentProperties:function(){function e(e,i){var n=typeof i;"function"===n?t[e]=i.call(t):"object"===n?t[e]=a(i,!0):t[e]=i}var t=this,i=u.merge(t,"properties");for(var n in i)e(n,i[n])}};o(r.prototype,l),r.extend=n,t.exports=r},{"./lib/clone":14,"./lib/createUID":15,"./lib/extend":20,"./lib/fromSuper":22,"./lib/inherits":25}],6:[function(e,t,i){"use strict";function n(e,t,i){return function(){var n=this;if(!(n instanceof d))throw new Error(i+" invoked with wrong context");if(n._state!==c.pending)return n;n._args=a(arguments);var r=t?n._args.shift():void 0;return n._state=e,n.trigger(r),n}}var r=e("./WBClass"),s=e("./WBPromise"),o=e("./lib/assert"),a=e("./lib/toArray"),c={pending:0,resolved:2,rejected:4},u={0:["pending"],2:["resolved","resolve"],4:["rejected","reject"]},l={properties:{_state:c.pending,_args:[],handlers:[]},initialize:function(e){var t=this;t._context=e},state:function(){var e=this;return u[e._state][0]},trigger:function(e){var t=this;if(t._state!==c.pending)for(var i,n=t.handlers;n.length;)i=n.shift(),t.invoke(i,e||t._context)},invoke:function(e,t){var i=this,n=i._state,r=e.context||t||i,s=e.args;i._args.forEach(function(e){s.push(e)});var o=e.type,a="then"===o||"done"===o&&n===c.resolved||"fail"===o&&n===c.rejected;a&&e.fn.apply(r,s)},promise:function(){var e=this;return e._promise=e._promise||new s(this),e._promise}};["then","done","fail"].forEach(function(e){l[e]=function(){var t=this,i=a(arguments),n=i.shift(),r=i.shift();return o["function"](n,e+" accepts only functions"),t.handlers.push({type:e,context:r,fn:n,args:i}),t.trigger(),t}}),l.always=l.then,[c.resolved,c.rejected].forEach(function(e){var t=u[e][1];l[t]=n(e,!1,t),l[t+"With"]=n(e,!0,t)});var d=r.extend(l);t.exports=d},{"./WBClass":5,"./WBPromise":9,"./lib/assert":13,"./lib/toArray":29}],7:[function(e,t,i){"use strict";var n=e("./WBClass").extend({mixins:[e("./mixins/WBBindableMixin"),e("./mixins/WBEventsMixin")]});t.exports=n},{"./WBClass":5,"./mixins/WBBindableMixin":34,"./mixins/WBEventsMixin":36}],8:[function(e,t,i){"use strict";var n=e("./lib/extend"),r=e("./lib/clone"),s=e("./lib/assert"),o=e("./WBSingleton"),a=o.extend({applyTo:function(e){var t,i=r(this.Behavior,!0);"function"==typeof i.initialize&&(t=i.initialize,delete i.initialize);var s=i.properties;return delete i.properties,n(e,i),t&&t.apply(e),s&&n(e,s),e},applyToClass:function(e){s["class"](e,"applyToClass expects a class");var t=e.prototype,i=r(this.Behavior,!0),o=i.initialize;"function"==typeof o&&(!t.hasOwnProperty("initializers")&&(t.initializers=[]),t.initializers.push(o),delete i.initialize);var a=i.properties;return delete i.properties,n(t,i),!t.hasOwnProperty("properties")&&(t.properties={}),a&&n(t.properties,a),e}});a.extend=function(e,t){e||(e={}),t||(t={});var i=r(this.Behavior,!0);t.Behavior=n(i,e);var s=o.extend.call(this,t);return s.extend=a.extend,s},t.exports=a},{"./WBSingleton":10,"./lib/assert":13,"./lib/clone":14,"./lib/extend":20}],9:[function(e,t,i){"use strict";function n(e){return function(){var t=this.deferred;return t[e].apply(t,arguments),this}}var r=e("./WBClass"),s={constructor:function(e){this.deferred=e},promise:function(){return this},state:function(){return this.deferred.state()}};["done","fail","then"].forEach(function(e){s[e]=n(e)}),s.always=s.then,t.exports=r.extend(s)},{"./WBClass":5}],10:[function(e,t,i){"use strict";function n(e,t){for(var i;e.length;)i=e.shift(),"function"==typeof i.applyTo&&i.applyTo(t)}function r(e){e=e||{};var t=this||c;a.prototype=t;var i=new a,u=e.mixins||[];return e.mixins=void 0,n(u,i),s(i,e),i.extend=r,i.uid=o(),i}var s=e("./lib/extend"),o=e("./lib/createUID"),a=function(){};a.prototype={extend:r};var c=new a;t.exports=c},{"./lib/createUID":15,"./lib/extend":20}],11:[function(e,t,i){"use strict";var n=e("./WBClass"),r=e("./mixins/WBDestroyableMixin"),s=r.Behavior.destroy,o=n.extend({mixins:[e("./mixins/WBEventsMixin"),e("./mixins/WBStateMixin"),e("./mixins/WBBindableMixin"),r],initialize:function(e){var t=this;e&&(t.attributes=e)},sync:function(e,t,i){i&&"function"==typeof i.success&&i.success()},fetch:function(e){var t=this,i=e.success,n=this;return e.success=function(t){return n.set(t,e)?(i&&i(n,t,e),void n.trigger("sync",n,t,e)):!1},t.sync("read",t,e)},save:function(e,t,i){var n=this;return n.destroying||(n.set(e,t,i),"object"==typeof e&&(i=t),n.sync("update",n,i)),n},destroy:function(e){var t=this;t.destroying||(t.destroying=!0,s.call(t,e),t.attributes={},t.sync("delete",t,e))}});t.exports=o},{"./WBClass":5,"./mixins/WBBindableMixin":34,"./mixins/WBDestroyableMixin":35,"./mixins/WBEventsMixin":36,"./mixins/WBStateMixin":37}],12:[function(e,t,i){"use strict";t.exports={lib:e("./lib"),BaseEventEmitter:e("./BaseEventEmitter"),BaseSingleton:e("./BaseSingleton"),WBClass:e("./WBClass"),WBDeferred:e("./WBDeferred"),WBEventEmitter:e("./WBEventEmitter"),WBMixin:e("./WBMixin"),WBSingleton:e("./WBSingleton"),WBStateModel:e("./WBStateModel"),mixins:e("./mixins")}},{"./BaseEventEmitter":3,"./BaseSingleton":4,"./WBClass":5,"./WBDeferred":6,"./WBEventEmitter":7,"./WBMixin":8,"./WBSingleton":10,"./WBStateModel":11,"./lib":24,"./mixins":39}],13:[function(e,t,i){"use strict";function n(e,t){if(!e)throw new Error(t||"")}function r(e){n[e]=function(t,i){n(typeof t===e,i)}}var s=Array.isArray;n.empty=function(e,t){var i=s(e)?e:Object.keys(e);n(0===i.length,t)},n.array=function(e,t){n(s(e),t)},n["class"]=function(e,t){var i=e.prototype;n(i&&i.constructor===e,t)},n.number=function(e,t){n("number"==typeof e&&!isNaN(e),t)};for(var o=["undefined","boolean","string","function","object"];o.length;)r(o.shift());t.exports=n},{}],14:[function(e,t,i){"use strict";function n(e,t){if(e=e.slice(),t){for(var i,n=[];e.length;)i=e.shift(),i=i instanceof Object?o(i,t):i,n.push(i);e=n}return e}function r(e){return new Date(e.getTime())}function s(e,t){var i={};for(var n in e)if(e.hasOwnProperty(n)){var s=e[n];s instanceof Date?i[n]=r(s):"object"==typeof s&&null!==s&&t?i[n]=o(s,t):i[n]=s}return i}function o(e,t){return a(e)?n(e,t):s(e,t)}var a=Array.isArray;t.exports=o},{}],15:[function(e,t,i){"use strict";function n(){return 4294967295*f()|0}function r(){var e=n();return l[e&u]+l[e>>8&u]+l[e>>16&u]+l[e>>24&u]}function s(){var e=n();return l[e&u]+l[e>>8&u]+"-"+l[e>>16&15|64]+l[e>>24&u]}function o(){var e=n();return l[63&e|128]+l[e>>8&u]+"-"+l[e>>16&u]+l[e>>24&u]}function a(){var e=n();return l[e&u]+l[e>>8&u]+l[e>>16&u]+l[e>>24&u]}function c(e){var t=[r(),s(),o(),a()].join("-");return(e?e:"").toString()+t}for(var u=255,l=[],d=0;256>d;d++)l[d]=(16>d?"0":"")+d.toString(16);var f=Math.random;t.exports=c},{}],16:[function(e,t,i){"use strict";function n(e,t,i){var n;return function(){var r=this,s=arguments,o=function(){n=null,i||e.apply(r,s)},a=i&&!n;clearTimeout(n),n=setTimeout(o,t),a&&e.apply(r,s)}}t.exports=n},{}],17:[function(e,t,i){"use strict";function n(e){var t=r(arguments);return t[0]=1,t.unshift(e),s.apply(null,t)}var r=e("./toArray"),s=e("./delay");t.exports=n},{"./delay":18,"./toArray":29}],18:[function(e,t,i){"use strict";function n(e,t,i){var n=r(arguments,3);return setTimeout(function(){var t=i&&i.destroyed;!t&&e.apply(i,n)},t)}var r=e("./toArray");t.exports=n},{"./toArray":29}],19:[function(e,t,i){"use strict";var n=e("./assert"),r=e("./toArray"),s=e("./clone"),o=/\s+/,a={trigger:"Cannot trigger event(s) without event name(s)",events:"Cannot bind/unbind without valid event name(s)",callback:"Cannot bind/unbind to an event without valid callback function"},c={properties:{_events:{},_cache:{}},on:function(e,t,i){var r=this;return n.string(e,a.events),n["function"](t,a.callback),r.iterate(e,function(e){r.bind(e,t,i);var n=r._cache;n[e]&&t.apply(i||r,n[e])}),r},off:function(e,t,i){var r=this;if(e&&n.string(e,a.events),!e&&!t&&!i)return r._events={},r;var s=e||Object.keys(r._events);return r.iterate(s,function(e){r.unbind(e,t,i)}),r},once:function(e,t,i){var n=this,s=r(arguments);return s[1]=function(){n.off.apply(n,s),t.apply(i||n,arguments)},n.on.apply(n,s),n},publish:function(e){var t=this,i=r(arguments);return n.string(e,a.events),t.iterate(e,function(e){var n=t._cache;n[e]||(n[e]=i.slice(1),i[0]=e,t.trigger.apply(t,i))}),t},unpublish:function(e){var t=this;return n.string(e,a.events),t.iterate(e,function(e){t._cache[e]=void 0}),t},unpublishAll:function(){var e=this;return e._cache={},e},trigger:function(e){var t=this;n.string(e,a.trigger);var i=r(arguments,1);return t.iterate(e,function(e){t.triggerEvent(e,i)}),t},triggerEvent:function(e,t){for(var i,n=this,r=n._events||{},s=[],o=e.split(":");o.length;)s.push(o.shift()),i=s.join(":"),i in r&&n.triggerSection(i,o,t)},triggerSection:function(e,t,i){var n=this,r=n._events||{},o=r[e]||[];o.forEach(function(e){var r;t.length&&(r=s(i),r.unshift(t)),e.callback.apply(e.context||n,r||i)})},iterate:function(e,t){var i=this,r=e;for("string"==typeof r?r=r.split(o):n.array(r);r.length;)t.call(i,r.shift())},bind:function(e,t,i){var n=this,r=n._events||{},s=r[e]||(r[e]=[]);return s.push({callback:t,context:i}),n},unbind:function(e,t,i){for(var n,r=this,s=r._events,o=s[e]||[],a=[],c=-1,u=o.length;++c<u;)n=o[c],(t&&t!==n.callback||i&&i!==n.context)&&a.push(n);return s[e]=a,r}};t.exports=c},{"./assert":13,"./clone":14,"./toArray":29}],20:[function(e,t,i){"use strict";function n(){var e=r(arguments);o(e.length>0,"extend expect one or more objects");for(var t=e.shift();e.length;)s(t,e.shift());return t}var r=e("./toArray"),s=e("./merge"),o=e("./assert");t.exports=n},{"./assert":13,"./merge":27,"./toArray":29}],21:[function(e,t,i){"use strict";function n(e,t,i){for(var n=0,r=e.length;r>n;n++)if(t.call(i,e[n],n,e)===!1)return}function r(e,t,i){for(var n in e)if(e.hasOwnProperty(n)&&t.call(i,e[n],n)===!1)return}function s(e,t,i){var s=Array.isArray(e)?n:r;s(e,t,i)}t.exports=s},{}],22:[function(e,t,i){"use strict";function n(e,t){var i=e.constructor,r=i.prototype,a={};e.hasOwnProperty(t)?a=e[t]:r.hasOwnProperty(t)&&(a=r[t]);var c=i&&i.__super__;return c&&(a=s(n(c,t),a)),o({},a)}function r(e,t){var i=e.constructor,n=i.prototype,s=[];e.hasOwnProperty(t)?s=e[t]:n.hasOwnProperty(t)&&(s=n[t]);var o=i&&i.__super__;return o&&(s=[].concat(r(o,t),s)),[].concat(s)}var s=e("./merge"),o=e("./extend");t.exports={merge:n,concat:r}},{"./extend":20,"./merge":27}],23:[function(e,t,i){"use strict";function n(e){var t=[];for(var i in e)"function"==typeof e[i]&&t.push(i);return t}t.exports=n},{}],24:[function(e,t,i){"use strict";t.exports={assert:e("./assert"),clone:e("./clone"),createUID:e("./createUID"),debounce:e("./debounce"),defer:e("./defer"),delay:e("./delay"),events:e("./events"),extend:e("./extend"),forEach:e("./forEach"),fromSuper:e("./fromSuper"),functions:e("./functions"),inherits:e("./inherits"),isEqual:e("./isEqual"),merge:e("./merge"),size:e("./size"),toArray:e("./toArray"),when:e("./when"),where:e("./where")}},{"./assert":13,"./clone":14,"./createUID":15,"./debounce":16,"./defer":17,"./delay":18,"./events":19,"./extend":20,"./forEach":21,"./fromSuper":22,"./functions":23,"./inherits":25,"./isEqual":26,"./merge":27,"./size":28,"./toArray":29,"./when":30,"./where":31}],25:[function(e,t,i){"use strict";function n(e,t,i){var n;return n=t&&t.hasOwnProperty("constructor")?t.constructor:function(){return e.apply(this,arguments)},r(n,e),n.prototype=Object.create(e.prototype),r(n.prototype,t),n.prototype.constructor=n,r(n,i),n.__super__=e.prototype,n}var r=e("./extend");t.exports=n},{"./extend":20}],26:[function(e,t,i){"use strict";function n(e,t){return e===t}t.exports=n},{}],27:[function(e,t,i){"use strict";function n(e){for(var t,i=r(arguments,1);i.length;){t=i.shift();for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}return e}var r=e("./toArray");t.exports=n},{"./toArray":29}],28:[function(e,t,i){"use strict";function n(e){return!Array.isArray(e)&&(e=Object.keys(e)),e.length}t.exports=n},{}],29:[function(e,t,i){"use strict";function n(e){return e=e>0?e:0,new Array(e)}function r(e,t){for(var i=t||0,r=e.length,s=n(r-i),o=i;r>o;o++)s[o-i]=e[o];return s}t.exports=r},{}],30:[function(e,t,i){"use strict";function n(){function e(){n.rejectWith(this)}function t(){if("rejected"!==n.state()){var e=a-o.length-1;if(c[e]=s(arguments),o.length){var i=o.shift();i.done(t)}else c.unshift(this),n.resolveWith.apply(n,c)}}var i=this,n=new r(i),o=s(arguments);1===o.length&&Array.isArray(o[0])&&(o=o[0]);var a=o.length,c=new Array(a);if(o.length){o.forEach(function(t){t.fail(e)});var u=o.shift();u.done(t)}else n.resolve();return n.promise()}var r=e("../WBDeferred"),s=e("./toArray");t.exports=n},{"../WBDeferred":6,"./toArray":29}],31:[function(e,t,i){"use strict";function n(e,t){var i=[];return r(e,function(e){for(var n in t){if(e[n]!==t[n])return;i.push(e)}}),i}var r=e("./forEach");t.exports=n},{"./forEach":21}],32:[function(e,t,i){"use strict";var n=e("../WBMixin"),r=e("../lib/fromSuper"),s=n.extend({initialize:function(){var e=this;e.controllers=[],e.implemented=[],e["implements"]=r.concat(e,"implements"),e.createControllerInstances(),e.bindOnceTo(e,"destroy","destroyControllers")},createControllerInstances:function(){var e=this,t=e["implements"];"function"==typeof t&&(t=t.call(e));var i,n,r;for(r=t.length;r--;)i=t[r],e.implemented.indexOf(i.toString())<0&&(n=new i(e),e.controllers.push(n),n.parent=e,e.trackImplementedSuperConstructors(i));return e.implemented},trackImplementedSuperConstructors:function(e){var t=this,i=e.__super__,n=i&&i.constructor;n&&(t.implemented.push(n.toString()),t.trackImplementedSuperConstructors(n))},destroyControllers:function(){for(var e,t=this,i=t.controllers;i.length;)e=i.shift(),e.destroyed||e.destroy()}});t.exports=s},{"../WBMixin":8,"../lib/fromSuper":22}],33:[function(e,t,i){"use strict";var n=e("../WBMixin"),r=e("../lib/fromSuper"),s=e("../lib/clone"),o=n.extend({initialize:function(){var e=this,t=r.merge(e,"observes");for(var i in t)e.bindToTarget(e.resolveTarget(i),t[i])},bindToTarget:function(e,t){var i=this;for(var n in t)i.bindHandlers(e,n,t[n])},bindHandlers:function(e,t,i){var n=this;for(i="string"==typeof i?[i]:s(i);i.length;)n.bindTo(e,t,i.shift())},resolveTarget:function(e){var t=this;if("self"===e)return t;var i=t[e];if(!i&&"string"==typeof e&&e.indexOf(".")>-1)for(e=e.split("."),i=t;e.length&&i;)i=i[e.shift()];return i}});t.exports=o},{"../WBMixin":8,"../lib/clone":14,"../lib/fromSuper":22}],34:[function(e,t,i){"use strict";var n=e("../WBMixin"),r=e("../lib/createUID"),s=n.extend({properties:{_bindings:{},_namedEvents:{}},callbackFactory:function(e,t){var i,n=this;return i="string"==typeof e?n.stringCallbackFactory(e,t):n.functionCallbackFactory(e,t)},stringCallbackFactory:function(e,t){return function(){t[e].apply(t,arguments)}},functionCallbackFactory:function(e,t){return function(){e.apply(t,arguments)}},bindTo:function(e,t,i,n){var s=this;s.checkBindingArgs.apply(s,arguments);var o=n||s,a=s.isAlreadyBound(e,t,i,o);if(a)return a;var c,u;s.isTargetJquery(e)?(c=s.callbackFactory(i,o),u=[t,c]):(c="string"==typeof i?o[i]:i,u=[t,c,o]),e.on.apply(e,u);var l={uid:r(),target:e,event:t,originalCallback:i,callback:c,context:o};return s._bindings[l.uid]=l,s.addToNamedBindings(t,l),l},isTargetJquery:function(e){var t=e.constructor;return t&&t.fn&&t.fn.on===e.on},bindOnceTo:function(e,t,i,n){var s=this;s.checkBindingArgs.apply(s,arguments),n=n||s;var o=s.isAlreadyBound(e,t,i,n);if(o)return o;var a=function(){("string"==typeof i?n[i]:i).apply(n,arguments),s.unbindFrom(c)},c={uid:r(),target:e,event:t,originalCallback:i,callback:a,context:n};return e.on(t,a,n),s._bindings[c.uid]=c,s.addToNamedBindings(t,c),c},unbindFrom:function(e){var t=this,i=e&&e.uid;if(!e||"string"!=typeof i)throw new Error("Cannot unbind from undefined or invalid binding");var n=e.event,r=e.context,s=e.callback,o=e.target;if(n&&s&&o&&r){o.off(n,s,r);for(var a in e)"uid"!==a&&delete e[a];delete t._bindings[i];var c=t._namedEvents,u=c[n];if(u){for(var l=u&&u.slice(0),d=u.length-1;d>=0;d--)u[d].uid===i&&l.splice(d,1);c[n]=l}}},unbindFromTarget:function(e){var t=this;if(!e||"function"!=typeof e.on)throw new Error("Cannot unbind from undefined or invalid binding target");var i;for(var n in t._bindings)i=t._bindings[n],i.target===e&&t.unbindFrom(i)},unbindAll:function(){var e,t=this;for(var i in t._bindings)e=t._bindings[i],t.unbindFrom(e)},checkBindingArgs:function(e,t,i,n){if(n=n||this,!e||"function"!=typeof e.on)throw new Error("Cannot bind to undefined target or target without #on method");if(!t||"string"!=typeof t)throw new Error("Cannot bind to target event without event name");if(!i||"function"!=typeof i&&"string"!=typeof i)throw new Error("Cannot bind to target event without a function or method name as callback");if("string"==typeof i&&!n[i])throw new Error("Cannot bind to target using a method name that does not exist for the context")},isAlreadyBound:function(e,t,i,n){var r=this,s=r._namedEvents[t];if(s)for(var o=0,a=s.length;a>o;o++){var c=s[o]||{},u=c.target;if(!u)return!1;var l=e.uid?e.uid===u.uid:!1;if(c.originalCallback===i&&c.context===n&&l)return c}return!1},addToNamedBindings:function(e,t){var i=this;i._namedEvents[e]||(i._namedEvents[e]=[]),i._namedEvents[e].push(t)}});t.exports=s},{"../WBMixin":8,"../lib/createUID":15}],35:[function(e,t,i){"use strict";function n(){}function r(e){var t=this;"string"==typeof e&&(e=t[e]),"function"==typeof e&&e.call(t)}var s=e("../lib/forEach"),o=e("../WBMixin"),a=["unbind","unbindAll","onDestroy"],c=o.extend({destroy:function(){var e=this;e.trigger("destroy"),s(a,r,e),e.destroyObject(e),e.destroyed=!0},destroyObject:function(e){var t=this;for(var i in e)t.destroyKey(i,e)},destroyKey:function(e,t){t.hasOwnProperty(e)&&"uid"!==e&&"cid"!==e&&("function"==typeof t[e]?t[e]=n:t[e]=void 0)}});t.exports=c},{"../WBMixin":8,"../lib/forEach":21}],36:[function(e,t,i){"use strict";var n=e("../WBMixin"),r=e("../lib/events"),s=n.extend(r);t.exports=s},{"../WBMixin":8,"../lib/events":19}],37:[function(e,t,i){"use strict";var n=e("../lib/clone"),r=e("../lib/merge"),s=e("../lib/extend"),o=e("../lib/isEqual"),a=e("../WBMixin"),c=a.extend({attributes:{},options:{},initialize:function(e,t){var i=this;i.attributes=s({},i.defaults,e),i.options=t||{},i.changed={}},get:function(e){return console.warn("getters are deprecated"),this.attributes[e]},set:function(e,t,i){var n=this;if(null===e)return n;var s,o;if("object"==typeof e?(s=e,i=t):(s={},s[e]=t),i||(i={}),i.silent)r(n.attributes,o);else{var a=n.changes(s,i);n._trigger(s,a,i)}return n},unset:function(e,t){return this.set(e,void 0,s({},t,{unset:!0}))},clear:function(e){var t=this;return t.set(t.defaults,e)},changes:function(e,t){var i,r,s=this,a=[],c=n(s.attributes,!0),u=s.attributes;s.changed={};for(i in e)r=e[i],o(u[i],r)||a.push(i),o(c[i],r)?delete s.changed[i]:s.changed[i]=r,u[i]=t.unset?void 0:r;return a},_trigger:function(e,t,i){for(var n,r=this,s=r.attributes;t&&t.length&&r.trigger;)n=t.shift(),r.trigger("change:"+n,r,s[n],i)}});t.exports=c},{"../WBMixin":8,"../lib/clone":14,"../lib/extend":20,"../lib/isEqual":26,"../lib/merge":27}],38:[function(e,t,i){"use strict";var n=e("../WBMixin"),r=e("../WBDeferred"),s=e("../lib/when"),o=e("../lib/toArray"),a=e("../lib/forEach"),c=e("../lib/delay"),u=e("../lib/defer"),l=e("../lib/functions"),d=n.extend({deferred:function(){var e=this;return new r(e)},when:function(){var e=this;return s.apply(e,arguments)},defer:function(e){var t=this,i=o(arguments);return i[1]=i[1]||this,"string"==typeof e&&(i[0]=t[e]),u.apply(null,i)},delay:function(e){var t=this,i=o(arguments);return i[2]=i[2]||t,"string"==typeof e&&(i[0]=t[e]),c.apply(null,i)},forEach:function(e,t,i){var n=this;i=i||n,"string"==typeof t&&(t=n[t]),a(e,t,i)},functions:function(e){return l(e||this)}});t.exports=d},{"../WBDeferred":6,"../WBMixin":8,"../lib/defer":17,"../lib/delay":18,"../lib/forEach":21,"../lib/functions":23,"../lib/toArray":29,"../lib/when":30}],39:[function(e,t,i){"use strict";t.exports={ControllableMixin:e("./ControllableMixin"),ObservableHashMixin:e("./ObservableHashMixin"),WBBindableMixin:e("./WBBindableMixin"),WBDestroyableMixin:e("./WBDestroyableMixin"),WBEventsMixin:e("./WBEventsMixin"),WBStateMixin:e("./WBStateMixin"),WBUtilsMixin:e("./WBUtilsMixin")}},{"./ControllableMixin":32,"./ObservableHashMixin":33,"./WBBindableMixin":34,"./WBDestroyableMixin":35,"./WBEventsMixin":36,"./WBStateMixin":37,"./WBUtilsMixin":38}],40:[function(e,t,i){"use strict";t.exports={release:"0.0.0",clientID:void 0,webSocketTimeout:15e3,api:{host:"https://a.wunderlist.com/api"},realtime:{host:"wss://socket.wunderlist.com:8443/api/v1/sync"}}},{}],41:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.WBDeferred,s=r.prototype,o=r.extend({properties:{loadDurationTime:void 0,loadStarted:!1,loadStartTime:void 0,latencyTime:void 0,startTime:void 0,url:void 0,xhr:void 0},error:s.fail});t.exports=o},{"wunderbits.core":12}],42:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.WBDeferred,s=r.extend({properties:{startTime:void 0,endTime:void 0,requestID:void 0,uri:void 0}});t.exports=s},{"wunderbits.core":12}],43:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.WBSingleton,s=n.mixins.WBBindableMixin,o=n.mixins.WBEventsMixin,a=e("../io/IO"),c=15e3,u=r.extend({mixins:[s,o],init:function(e){var t=this;t.setupIO(e.config),t.startPolling()},destroy:function(){var e=this;e.poller&&clearInterval(e.poller)},setupIO:function(e){var t=this;t.io||(t.io=new a({config:e}).io)},startPolling:function(){var e=this;e.poller&&clearInterval(e.poller),e.poller=setInterval(function(){e.checkApiHealth()},c)},checkApiHealth:function(){var e=this;e.io.get("/health").done(e.onHealthy,e).fail(e.onUnhealthy,e)},onHealthy:function(){var e=this;e.trigger("healthy")},onUnhealthy:function(){var e=this;e.trigger("unhealthy")}});t.exports=u},{"../io/IO":46,"wunderbits.core":12}],44:[function(e,t,i){(function(i){"use strict";var n=e("wunderbits.core"),r=n.WBSingleton,s=i.navigator||{},o=i.process||{},a=s.userAgent||"node "+o.version,c=r.extend({headers:{"x-client-platform":"web","x-client-product":"wunderlist","x-client-product-version":null,"x-client-system":a,"x-client-system-version":"Standard","x-client-product-git-hash":null},init:function(e){var t=this,i=e,n=t.headers;n["x-client-product-version"]=i.release;var r=/\[(.*)\]/.exec(i.gitHash);r=r&&r[1],n["x-client-product-git-hash"]=r||"dev",i.testing&&(n["x-client-testing"]="true"),i.product&&(n["x-client-product"]=i.product)}});t.exports=c}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"wunderbits.core":12}],45:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.WBSingleton,s=r.extend({compileParams:function(e){var t,i=!0,n="";for(var r in e)t=encodeURIComponent(e[r]),n+=(i?"?":"&")+r+"="+encodeURIComponent(t),i&&(i=!1);return n},generateURI:function(e,t){var i=this;return e+i.compileParams(t)}});t.exports=s},{"wunderbits.core":12}],46:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.lib.createUID,s=n.WBDeferred,o=n.mixins.WBBindableMixin,a=n.mixins.WBEventsMixin,c=e("../validators/SchemaValidator"),u=e("./IOBase"),l=u.prototype,d=e("magiconsole"),f=new d("SDK:IO"),p=u.extend({mixins:[o,a],initialize:function(e){var t=this;l.initialize.apply(t,arguments),t.config=e.config,t.requests={},t.wrapVerbs()},wrapVerbs:function(){var e=this,t=e.io;["get","patch","post","put","delete"].forEach(function(i){t["_"+i]=t[i],t[i]=e.requestWrapper.bind(e,i)})},requests:{},tokens:{id:"([-])?[0-9]+",version:"v(\\d)+",provider:"[a-z]+"},routes:{api:[]},authFreeRoutes:{api:["health","{{version}}/oauth/{{provider}}/exchange","{{version}}/signup","{{version}}/authenticate","{{version}}/user/password/reset"]},normalizeUrl:function(e){var t=this;return t.config.api.host+e},extendHeaders:function(e){var t=this,i=t.config.clientID,n=t.config.deviceID,r=t.config.instanceID;return i&&(e["x-client-id"]=i),n&&(e["x-client-device-id"]=n),r&&(e["x-client-instance-id"]=r),"function"==typeof t.config.extendHeaders&&t.config.extendHeaders(e),l.extendHeaders.apply(t,arguments)},setAuthorization:function(e){var t=this,i=t.config.accessToken;i&&(e["x-access-token"]=i)},requestWrapper:function(e,t,i,n,r){var o=this,a=new s,u={};return n||(n=o.generateUID()),o.requests[n]=a,u["x-client-request-id"]=n,r=r?parseInt(r,10):6e4,o.io["_"+e](t,i,u,r).done(function(e,i){Array.isArray(e)?e.forEach(function(e){e.type&&c.validateData(e,e.type)}):e&&e.type&&c.validateData(e,e.type),f.log(i.status,t),a.resolve(e,i.status)}).fail(function(e,i){f.error(i.status,i.statusText,t),a.reject(e,i.status),401===i.status&&o.trigger("unauthorized")}).always(function(){o.requests[n]=void 0}),a.promise()},generateUID:function(){for(var e,t=this;!e||!t.isUIDValid(e);)e=r();return e},isUIDValid:function(e){return!(e in this.requests)},cancelInflightCreate:function(e,t,i){var n=this,r=n.requests[e];if(f.debug("cancelling request locally",e,"alive?",!!r),r){n.requests[e]=void 0;var s=t?{id:t}:{};s.revision=i,r.resolve(s,200)}}});t.exports=p},{"../validators/SchemaValidator":110,"./IOBase":47,magiconsole:1,"wunderbits.core":12}],47:[function(e,t,i){(function(i){"use strict";var n=e("wunderbits.core"),r=n.WBClass,s=n.WBDeferred,o=n.lib.assert,a=n.lib.extend,c=e("./io/AjaxTransport"),u=e("../helpers/PlatformHeaders"),l=r.prototype,d=/^(https?:)?\/\//,f=/^(https?:)?\/\/\w+\.wunderlist.com\//;t.exports=r.extend({initialize:function(e){var t=this;t.config=e.config,c.maxRequests=t.config.maxHttpRequests||5,l.initialize.apply(t,arguments),t.io=c.ajax.bind(c);for(var i=["delete","get","patch","post","put"],n=0,r=i.length;r>n;n++)t.defineVerb(i[n]);t.routes=t.compileRoutes(t.routes,t.tokens),t.authFreeRoutes=t.compileRoutes(t.authFreeRoutes,t.tokens)},compileRoutes:function(e,t){function i(e){return e.replace(/\{\{(\w+)\}\}/g,function(e,i){return t[i]})}var n=this;if(!e)return void 0;var r={};for(var s in e){var o=e[s];o=o.map(i);var a=new RegExp("^/("+o.join("|")+")(\\?|$)"),c=n.config[s].host;r[c]=a}return r},resolveUrl:function(e){var t,i=this;return d.test(e)?e:(i.routes&&(t=i.resolveRoute(e)),t||(t=i.normalizeUrl(e)),t)},resolveRoute:function(e){var t=this;for(var i in t.routes){var n=t.routes[i];if(n.test(e))return i+e}},normalizeUrl:function(e){var t=i.location;return t.protocol+"//"+t.host+e},extendHeaders:function(e,t){var i=this,n=d.test(t),r=!n||f.test(t);if(e=e||{},r&&a(e,u.headers),i.authFreeRoutes)for(var s in i.authFreeRoutes){var o=i.authFreeRoutes[s];if(o.test(t))return e}return r&&!e.Authorization&&i.setAuthorization(e,t),e},setAuthorization:function(){},defineVerb:function(e){var t=this;t.io[e]=function(i,n,r,a,c){o(i,"need a url for ajax calls"),r=r||{},r=t.extendHeaders(r,i);var u=new s,l=u.promise();if(i=t.resolveUrl(i),"object"==typeof n)if("get"===e){var d,f=[];for(d in n)f.push(d+"="+encodeURIComponent(n[d]));
f.length&&(i=i+"?"+f.join("&")),n=void 0}else n=JSON.stringify(n);return t.io(i,{type:e.toUpperCase(),data:n,headers:r,success:u.resolve.bind(u),error:u.reject.bind(u),timeout:a,context:c}),l}}})}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../helpers/PlatformHeaders":44,"./io/AjaxTransport":49,"wunderbits.core":12}],48:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.lib.createUID,s=n.lib.extend,o=n.WBEventEmitter,a=n.WBDeferred,c=e("../helpers/PlatformHeaders"),u=e("./mixins/RequestQueueMixin"),l=e("../deferreds/RestSocketRequestDeferred"),d=e("../wunderbits/lib/SafeParse"),f=e("../validators/SchemaValidator"),p=e("../helpers/URL"),v=e("./io/WebSocket"),h=e("magiconsole"),m=new h("SDK:RESTSOCKET"),g=u.extend({maxRequests:100,executeRequest:function(e){var t=this,i=e.options;t.socketRequest(e.deferred,i.method,i.uri,i.data,i.requestID,i.requestType).always(function(){delete t.executingRequests[e.queueID],t.checkQueue()})}}),b=o.prototype,y=o.extend({mixins:[g],timeout:6e4,socket:void 0,ready:void 0,requests:{},initialize:function(e){var t=this;b.initialize.apply(t,arguments),t.appState=e.appState,t.config=e.config,t.ready=new a,t.socket=new v(e),t.requests={},t.wrapVerbs(),t.pollForTimeouts(),t.bindToSocket(),t.ready.resolve()},destroy:function(){var e=this;e.unbindAll(),e.socket&&e.socket.destroy(),e.destroyed=!0},wrapVerbs:function(){var e=this,t=["get","post","put","patch","delete"];t.forEach(function(t){var i=e[t];e[t]=function(){return i.apply(e,arguments)}})},pollForTimeouts:function(){var e=this;e.timer&&clearInterval(e.timer),e.timer=setInterval(function(){e.checkForRequestTimeouts()},1e3)},close:function(){var e=this;e.socket&&e.socket.close()},bindToSocket:function(){var e=this;e.bindTo(e.socket,"open","onSocketConnect"),e.bindTo(e.socket,"message","onMessage"),e.bindTo(e.socket,"close","onSocketFalure"),e.bindTo(e.socket,"close","onSocketDisconnect"),e.bindTo(e.socket,"error","onSocketFalure")},onSocketConnect:function(e){var t=this;t.getSocketHealth().done(function(){t.connected=!0,t.trigger("connected",e),t.pollHealth()}).fail(t.close,t)},pollHealth:function(){var e=this;e.cancelPollHealth(),e.poller=setInterval(function(){e.connected?e.getSocketHealth().fail(e.close,e):e.cancelPollHealth()},15e3)},cancelPollHealth:function(){var e=this;e.poller&&clearInterval(e.poller)},getSocketHealth:function(){var e=this,t=e.request(void 0,void 0,void 0,void 0,"health").done(function(e,t){m.info("websocket healthy",e||"",t)}).fail(function(e,t){m.error("websocket not healthy",e||"",t)});return t.promise()},onSocketDisconnect:function(e){var t=this;t.cancelPollHealth(),t.connected=!1,t.trigger("disconnected",e)},onMessage:function(e){var t=this,i=d.json(e.data);i&&i.headers&&(i.headers=t.normalizeHeaders(i.headers));var n=t.extractRequestIDFromHeaders(i),r=n&&t.requests[n];switch(t.parseDataBody(i),i.type){case"request":r&&t.handleRequest(r,i,n);break;case"health":r&&t.handleHealthRequest(r,i,n);break;case"desktop_notification":t.handleDesktopNotification(i);break;case"mutation":t.isCorrectMutationVersion(i)&&t.handleMessage(i);break;default:t.handleMessage(i)}},extractRequestIDFromHeaders:function(e){return e&&e.headers&&e.headers["x-client-request-id"]},parseDataBody:function(e){e&&e.body&&(e.body=d.json(e.body))},isCorrectMutationVersion:function(e){var t=!1,i=e.subject.type,n=e.version,r=["file"],s=-1!==r.indexOf(i),o=2===n,a=1===n;return s&&(o||a)?t=!0:a&&(t=!0),t},handleRequest:function(e,t,i){var n=this;e.endTime=Date.now();var r=/^2/.test(t.status);n.logRequestTimings(r,e,t),Array.isArray(t.body)?t.body.forEach(function(e){e.type&&f.validateData(e,e.type)}):t.body&&t.body.type&&f.validateData(t.body,t.body.type),e[r?"resolve":"reject"](t.body,t.status),n.checkStillAuthorized(t.status),n.requests[i]=void 0},handleHealthRequest:function(e,t,i){var n=this;e.endTime=Date.now();var r=t.body&&t.body.healthy===!0;n.logRequestTimings(r,e,t),e[r?"resolve":"reject"](t.body,t.status),n.requests[i]=void 0},logRequestTimings:function(e,t,i){var n=[i.status,t.uri,t.endTime-t.startTime];e?(this.triggerTiming(t),m.info.apply(m,n)):m.error.apply(m,n)},triggerTiming:function(e){var t=this,i=e.startTime;e.loadDurationTime=e.endTime-i,e.latencyTime=e.loadDurationTime;var n={start:i,end:e.endTime,duration:e.loadDurationTime,latency:e.latencyTime,download:void 0,url:e.uri,type:"websocket"};t.trigger("timing:io",n)},checkStillAuthorized:function(e){var t="unauthorized";401===e&&this.trigger(t)},handleMessage:function(e){var t=this;m.debug("arbitrary message",e);var i=e&&e.subject&&e.subject.type;i&&f.validateData(e.data,i),t.trigger("event",e);var n=e&&e.operation;n&&t.trigger(n,e)},handleDesktopNotification:function(e){var t=this;t.trigger("desktopNotification",e)},request:function(e,t,i,n,r){var s=this,o={method:e,uri:t,data:i,requestID:n,requestType:r},a=s.queueRequest(t,o,l);return a.promise()},socketRequest:function(e,t,i,n,r,s){var o=this,a=o.socket;r=r||o.generateUID();var c=o.compileHeaders(r),u={type:s||"request",headers:o.normalizeHeaders(c)};return t&&(u.verb=t),i&&(u.uri=i),"POST"!==t&&"PATCH"!==t&&"PUT"!==t||!n||(u.body=JSON.stringify(n)),e.requestID=r,e.uri=i,e.startTime=Date.now(),o.requests[r]=e,o.appState.isOnline()&&o.socket.isConnected()?a.send(JSON.stringify(u)):e.reject({errors:["no websocket connection available"]},0),e.promise()},compileHeaders:function(e){var t=this,i={"x-client-request-id":e,"x-client-id":t.appState.attributes.clientID,"x-client-instance-id":t.appState.attributes.instanceID,"x-client-device-id":t.appState.attributes.deviceID,"content-type":"application/json",accept:"application/json"};i=s(i,c.headers),t.config&&"function"==typeof t.config.extendHeaders&&t.config.extendHeaders(i);var n;for(var r in i)n=i[r],(void 0===n||null===n)&&delete i[r];return i},normalizeHeaders:function(e){var t={};for(var i in e)t[i.toLowerCase()]=e[i];return t},requestWrapper:function(e,t,i,n){var r=this,s=new a;return t="/api"+t,r.ready.done(function(){r.request(e,t,i,n).done(s.resolve.bind(s)).fail(s.reject.bind(s))}),s.promise()},onSocketFalure:function(){var e,t=this;for(var i in t.requests)e=t.requests[i],e&&e.reject({errors:["websocket connection lost"]},0),t.requests[i]=void 0},checkForRequestTimeouts:function(){var e=this,t=Date.now();for(var i in e.requests)e.checkRequestIsTimedout(e.requests[i],t)},checkRequestIsTimedout:function(e,t){var i=this;e&&t-e.startTime>=i.timeout&&(m.error("timeout",e.uri,t-e.startTime),e.reject({errors:["request timedout locally due to no response in "+i.timeout]},408),i.requests[e.requestID]=void 0)},"delete":function(e,t,i){var n=e+p.compileParams(t);return this.requestWrapper("DELETE",n,void 0,i)},get:function(e,t,i){var n=e+p.compileParams(t);return this.requestWrapper("GET",n,void 0,i)},patch:function(e,t,i){return this.requestWrapper("PATCH",e,t,i)},post:function(e,t,i){return this.requestWrapper("POST",e,t,i)},put:function(e,t,i){return this.requestWrapper("PUT",e,t,i)},generateUID:function(){for(var e,t=this;!e||!t.isUIDValid(e);)e=r();return e},isUIDValid:function(e){return!(e in this.requests)},cancelInflightCreate:function(e,t,i){var n=this,r=n.requests[e];if(m.debug("cancelling request locally",e,"alive?",!!r),r){n.requests[e]=void 0;var s=t?{id:t}:{};s.revision=i,r.resolve(s,200)}}});t.exports=y},{"../deferreds/RestSocketRequestDeferred":42,"../helpers/PlatformHeaders":44,"../helpers/URL":45,"../validators/SchemaValidator":110,"../wunderbits/lib/SafeParse":112,"./io/WebSocket":52,"./mixins/RequestQueueMixin":53,magiconsole:1,"wunderbits.core":12}],49:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.WBSingleton,s=n.mixins.WBBindableMixin,o=n.mixins.WBEventsMixin,a=e("../../helpers/URL"),c=e("../../wunderbits/lib/SafeParse"),u=e("./NativeXMLHttpRequest"),l=e("../../deferreds/RequestDeferred"),d=e("../mixins/RequestQueueMixin"),f=d.extend({maxRequests:5,executeRequest:function(e){var t=this,i=e.url,n=e.options,r=e.deferred;t.executingRequests[e.queueID]=e;var s=t.xhrRequest(i,{type:n.type,data:n.data,headers:n.headers,timeout:n.timeout},r);s.done(function(e,i){t.onSuccess(e,i,n)}).fail(function(e,i){t.onFailure(e,i,n)}).always(function(){delete t.executingRequests[e.queueID],t.checkQueue()})}}),p=r.extend({mixins:[s,o,f],xhrRequest:function(e,t,i){var n=this,r=!0,s=t.type,o=t.data;o&&"GET"===s&&(e=a.generateURI(e,o),o=void 0);var c=new u;return n.attachXhrListeners(c,i),c.open(s,e,r),t.timeout&&(c.timeout=t.timeout),n.setupXhrHeaders(c,t.headers,o),i.startTime=Date.now(),o?c.send(o):c.send(),i.url=e,i.xhr=c,i},setupXhrHeaders:function(e,t,i){var n="application/json; charset=utf-8";if(t)for(var r in t)e.setRequestHeader(r.toLowerCase(),t[r]);i&&e.setRequestHeader("Content-Type",n),e.setRequestHeader("Accept",n)},attachXhrListeners:function(e,t){var i=this;e.addEventListener("progress",function(n){i.onXhrProgress(n,e,t)},!1),e.addEventListener("load",function(n){i.onXhrLoad(n,e,t)},!1),e.addEventListener("error",function(n){i.onXhrError(n,e,t)},!1),e.addEventListener("abort",function(n){i.onXhrAbort(n,e,t)},!1),e.addEventListener("timeout",function(n){i.onXhrTimeout(n,e,t)},!1)},onXhrLoad:function(e,t,i){var n=this,r=2===parseInt(t.status/100,10);r&&n.triggerTiming(i),i[r?"resolve":"reject"].call(i,t.responseText,t)},triggerTiming:function(e){var t=this,i=Date.now(),n=e.startTime,r=e.loadStartTime;e.loadDurationTime=i-r,e.latencyTime=r-n,t.trigger("timing:io",{start:n,end:i,duration:i-n,latency:e.latencyTime,download:e.loadDurationTime,url:e.url,type:"ajax"})},onXhrProgress:function(e,t,i){i.loadStarted||(i.loadStartTime=Date.now(),i.loadStarted=!0)},onXhrError:function(e,t,i){this.onXhrFail(e,t,i)},onXhrAbort:function(e,t,i){this.onXhrFail(e,t,i)},onXhrTimeout:function(e,t,i){this.onXhrFail(e,t,i)},onXhrFail:function(e,t,i){i.reject(t.responseText,t)},ajax:function(e,t){var i=this,n=i.queueRequest(e,t,l);return n},onSuccess:function(e,t,i){"string"==typeof e&&204!==t.status&&(e=c.json(e)),i.success&&i.success(e,t)},onFailure:function(e,t,i){var n=(t.getResponseHeader("content-type")||"").split(";")[0];"string"==typeof e&&/application\/json/.test(n)&&(e=c.json(t.responseText)),"function"==typeof i.error&&i.error(e,t)}});t.exports=p},{"../../deferreds/RequestDeferred":41,"../../helpers/URL":45,"../../wunderbits/lib/SafeParse":112,"../mixins/RequestQueueMixin":53,"./NativeXMLHttpRequest":51,"wunderbits.core":12}],50:[function(e,t,i){(function(i){"use strict";t.exports=i.WebSocket||e("ws")}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],51:[function(e,t,i){(function(i){"use strict";t.exports=i.XMLHttpRequest||e("xmlhttprequest").XMLHttpRequest}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],52:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.WBEventEmitter,s=n.lib.assert,o=e("../../helpers/URL"),a=e("./NativeWebSocket"),c=e("../../wunderbits/lib/bindAll"),u=e("magiconsole"),l=new u("SDK:WEBSOCKET"),d=r.prototype,f=r.extend({clientClosed:!1,NativeWebSocketClass:a,socket:void 0,initialize:function(e){var t=this;t.appState=e.appState,d.initialize.apply(t,arguments);var i=["onSocketClose","onSocketError","onSocketMessage","onSocketOpen"];c(t,i),t.validateToken(),t.connect(),t.bindToAppState()},destroy:function(){var e=this;e.close(),e.unbindAll(),e.destroyed=!0},bindToAppState:function(){var e=this;e.appState&&(e.unbindFrom(e.appState),e.bindTo(e.appState,"change:online",function(){e[e.appState.isOnline()?"connect":"close"]()}))},validateToken:function(){s.string(this.appState.attributes.accessToken,"Cannot instantiate class without an auth token.")},connect:function(){var e=this;e.socket&&e.close(),e.clientClosed=!1,e.clearSocketTimeout();var t=e.appState.attributes,i={client_id:t.clientID,access_token:t.accessToken,client_device_id:t.deviceID,client_instance_id:t.instanceID},n=e.appState.attributes.realtime.host,r=o.generateURI(n,i),s=e.NativeWebSocketClass;e.socket=new s(r),e.bindToSocket()},isConnected:function(){var e=this.socket;return!(!e||1!==e.readyState)},send:function(e){this.socket.send(e)},close:function(){var e=this;e.clientClosed=!0,e.socket&&(e.socket.close(),e.socket=void 0)},bindToSocket:function(){var e=this,t=e.socket;t.addEventListener("close",e.onSocketClose),t.addEventListener("error",e.onSocketError),t.addEventListener("message",e.onSocketMessage),t.addEventListener("open",e.onSocketOpen),e.trackTimeout()},trackTimeout:function(){var e=this,t=e.appState.attributes.webSocketTimeout,i=Date.now(),n=function(){e.socket&&0===e.socket.readyState&&(Date.now()-i<t?e.socketTimeout=setTimeout(n,1e3):(e.onSocketTimeout(),e.socket&&(e.socket.close(),e.socket=void 0)))};n()},clearSocketTimeout:function(){var e=this;e.socketTimeout&&clearTimeout(e.socketTimeout)},onSocketTimeout:function(e){var t=this;t.clearSocketTimeout(),l.error("timeout",e),t.trigger("timeout")},onSocketError:function(e){var t=this;t.clearSocketTimeout(),l.error("error",e),t.trigger("error",e)},onSocketOpen:function(e){var t=this;l.info("opened",e),t.trigger("open",e)},onSocketClose:function(e){var t=this;t.clearSocketTimeout(),t.socket=void 0,l.info("closed",e),t.trigger("close",e),!t.clientClosed&&t.appState.isOnline()&&setTimeout(function(){!t.destroyed&&t.connect()},1e3)},onSocketMessage:function(e){var t=this;t.trigger("message",e)}});t.exports=f},{"../../helpers/URL":45,"../../wunderbits/lib/bindAll":113,"./NativeWebSocket":50,magiconsole:1,"wunderbits.core":12}],53:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.lib.createUID,s=n.WBMixin;t.exports=s.extend({maxRequests:5,requestsQueue:[],executingRequests:{},reset:function(){var e=this;e.requestsQueue=[],e.executingRequests={}},checkQueue:function(){var e,t=this,i=Object.keys(t.executingRequests).length;i<t.maxRequests&&(e=t.requestsQueue.shift(),e&&t.executeRequest(e))},queueRequest:function(e,t,i){var n=this,s=new i;return n.requestsQueue.push({deferred:s,url:e,options:t,queueID:r()}),n.checkQueue(),s},executeRequest:function(e){throw new Error("You must override RequestQueueMixin#executeRequest!",e)}})},{"wunderbits.core":12}],54:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.WBDeferred,s=n.WBStateModel,o=n.lib.clone,a=e("../wunderbits/WBOnlineStatus"),c=s.prototype,u=s.extend({defaults:{api:{host:"https://a.wunderlist.com/api"},realtime:{host:"wss://socket.wunderlist.com:8443/api/v1/sync"},accessToken:void 0,clientID:void 0,debug:!1,online:!0,webSocketTimeout:15e3,maxHttpRequests:5,checkHealth:!0},initialize:function(){var e=this;c.initialize.apply(e,arguments),e.initialized=new r,setTimeout(function(){e.destroyed||(e.watchOnlineState(),e.initialized.resolve())})},destroy:function(){var e=this;e.onlineState&&e.onlineState.destroy(),c.destroy.apply(e,arguments)},watchOnlineState:function(){var e=this;e.onlineState&&(e.unbindFrom(e.onlineState),e.onlineState.destroy()),e.onlineState=new a({config:e.toJSON()}),e.set("online",e.onlineState.isOnline()),e.bindTo(e.onlineState,"online","onOnline"),e.bindTo(e.onlineState,"offline","onOffline")},onOnline:function(){this.set("online",!0)},onOffline:function(){this.set("online",!1)},isOnline:function(){return!!this.attributes.online},toJSON:function(){return o(this.attributes)}});t.exports=u},{"../wunderbits/WBOnlineStatus":111,"wunderbits.core":12}],55:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.lib.clone,s=n.lib.extend,o=e("./SchemaTypes");t.exports={id:o.id,task_id:o.id,list_id:o.id,user_id:o.id,revision:o["int"],type:o.str,created_at:o.ISODate,updated_at:o.ISODate,extend:function(e){return s(r(this),e)}}},{"./SchemaTypes":63,"wunderbits.core":12}],56:[function(e,t,i){"use strict";var n=e("./SchemaTypes");t.exports={id:n.id,title:n.str,list_ids:n.arr,user_id:n.id,created_at:n.ISODate,updated_at:n.ISODate,revision:n["int"],type:n.str}},{"./SchemaTypes":63}],57:[function(e,t,i){"use strict";var n=e("./SchemaTypes"),r=e("./BaseSchema");t.exports=r.extend({created_by_id:n.id,list_type:n.str,title:n.str})},{"./BaseSchema":55,"./SchemaTypes":63}],58:[function(e,t,i){"use strict";var n=e("./SchemaTypes"),r=e("./BaseSchema");t.exports=r.extend({sender_id:n.id,state:n.str,owner:n.bool})},{"./BaseSchema":55,"./SchemaTypes":63}],59:[function(e,t,i){"use strict";var n=e("./SchemaTypes"),r=e("./BaseSchema");t.exports=r.extend({content:n.str})},{"./BaseSchema":55,"./SchemaTypes":63}],60:[function(e,t,i){"use strict";var n=e("./SchemaTypes");t.exports={id:n.id}},{"./SchemaTypes":63}],61:[function(e,t,i){"use strict";var n=e("./SchemaTypes"),r=e("./BaseSchema");t.exports=r.extend({values:n.arr})},{"./BaseSchema":55,"./SchemaTypes":63}],62:[function(e,t,i){"use strict";var n=e("./SchemaTypes"),r=e("./BaseSchema");t.exports=r.extend({date:n.ISODate})},{"./BaseSchema":55,"./SchemaTypes":63}],63:[function(e,t,i){"use strict";t.exports={id:"integer","int":"integer",bool:"boolean",arr:"array",str:"string",ISODate:"ISODate"}},{}],64:[function(e,t,i){"use strict";var n=e("./SchemaTypes"),r=e("./BaseSchema");t.exports=r.extend({user_id:n.id,provider_id:n.str,provider_type:n.str})},{"./BaseSchema":55,"./SchemaTypes":63}],65:[function(e,t,i){"use strict";var n=e("./SchemaTypes"),r=e("./BaseSchema");t.exports=r.extend({key:n.str,value:n.str})},{"./BaseSchema":55,"./SchemaTypes":63}],66:[function(e,t,i){"use strict";var n=e("./SchemaTypes"),r=e("./BaseSchema");t.exports=r.extend({completed:n.bool,completed_at:n.ISODate,completed_by_id:n.id,created_by_id:n.id,title:n.str})},{"./BaseSchema":55,"./SchemaTypes":63}],67:[function(e,t,i){"use strict";var n=e("./SchemaTypes"),r=e("./BaseSchema");t.exports=r.extend({assignee_id:n.id,completed:n.bool,completed_at:n.ISODate,completed_by_id:n.id,created_by_id:n.id,due_date:n.ISODate,starred:n.bool,title:n.str})},{"./BaseSchema":55,"./SchemaTypes":63}],68:[function(e,t,i){"use strict";var n=e("./SchemaTypes"),r=e("./BaseSchema");t.exports=r.extend({read:n.bool,text:n.str})},{"./BaseSchema":55,"./SchemaTypes":63}],69:[function(e,t,i){"use strict";var n=e("./SchemaTypes");t.exports={id:n.id,name:n.str,organization_id:n.id,created_at:n.ISODate,updated_at:n.ISODate,revision:n["int"],team_type:n.str,type:n.str}},{"./SchemaTypes":63}],70:[function(e,t,i){"use strict";var n=e("./SchemaTypes"),r=e("./BaseSchema");t.exports=r.extend({name:n.str,email:n.str,pro:n.bool})},{"./BaseSchema":55,"./SchemaTypes":63}],71:[function(e,t,i){"use strict";var n=e("./Position");t.exports={list:e("./List"),folder:e("./Folder"),membership:e("./Membership"),note:e("./Note"),reminder:e("./Reminder"),setting:e("./Setting"),service:e("./Service"),subtask:e("./Subtask"),task:e("./Task"),task_comment:e("./TaskComment"),user:e("./User"),team:e("./Team"),organization:e("./Organization"),list_position:n,subtask_position:n,task_position:n}},{"./Folder":56,"./List":57,"./Membership":58,"./Note":59,"./Organization":60,"./Position":61,"./Reminder":62,"./Service":64,"./Setting":65,"./Subtask":66,"./Task":67,"./TaskComment":68,"./Team":69,"./User":70}],72:[function(e,t,i){"use strict";var n=e("./Conversations");t.exports=n.extend({baseUrl:"/activities",type:"activities"})},{"./Conversations":74}],73:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.lib.assert,s=e("./Service"),o=s.prototype;t.exports=s.extend({initialize:function(){var e=this;o.initialize.apply(e,arguments),e.validateAccessParams()},validateAccessParams:function(){var e=this,t=e.appState.attributes;r.string(t.clientID,"This service requires a client ID."),r.string(t.accessToken,"This service requires an access token.")}})},{"./Service":94,"wunderbits.core":12}],74:[function(e,t,i){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/conversations",type:"conversations",all:function(e,t){var i=this;return i.get(i.baseUrl,e,t).promise()}})},{"./AuthenticatedService":73}],75:[function(e,t,i){"use strict";var n=e("./ServiceGetOnly");t.exports=n.extend({baseUrl:"/export",type:"export",all:function(e){var t=this;return t.get(t.baseUrl,void 0,e,3e5).promise()}})},{"./ServiceGetOnly":95}],76:[function(e,t,i){"use strict";var n=e("./ServiceGetOnly");t.exports=n.extend({baseUrl:"/features",type:"feature"})},{"./ServiceGetOnly":95}],77:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.lib.assert,s=n.WBDeferred,o=e("magiconsole"),a=new o("SDK:SERVICE:FILES"),c=e("./AuthenticatedService"),u=c.prototype;t.exports=c.extend({apiVersion:2,baseUrl:"/files",type:"file",create:function(e,t){var i=this;try{i.validateCreateData(e)}catch(n){return a.error(n),(new s).reject({errors:[n.toString()]},0).promise()}var r=u.create.call(i,e,t);return r.promise()},validateCreateData:function(e){e=e||{};var t=Object.keys(e).length,i=" required for file creation";r(t,"data"+i),r.number(e.task_id,"data.task_id"+i)}})},{"./AuthenticatedService":73,magiconsole:1,"wunderbits.core":12}],78:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.lib.assert,s=n.WBDeferred,o=e("magiconsole"),a=new o("SDK:SERVICE:FOLDERS"),c=e("./Memberships"),u=e("./AuthenticatedService"),l=u.prototype;t.exports=u.extend({baseUrl:"/folders",type:"folder",initialize:function(e){var t=this;l.initialize.apply(t,arguments),t.membershipsService=new c(e)},create:function(e){var t=this;try{t.validateCreateData(e)}catch(i){return a.error(i),(new s).reject({errors:[i.toString()]},0).promise()}var n=l.create.apply(t,arguments);return n.promise()},accepted:function(){var e=this,t=new s;return e.membershipsService.mine().done(function(i){var n=i.filter(function(e){return"accepted"===e.state}),r=n.map(function(e){return e.folder_id});e.all().done(function(e){var i=e.filter(function(e){return r.indexOf(e.id)>-1});t.resolve(i)}).fail(t.reject,t)}).fail(t.reject,t),t.promise()},validateCreateData:function(e){e=e||{},r(e.title,"Title is required for folder creation.")}})},{"./AuthenticatedService":73,"./Memberships":84,magiconsole:1,"wunderbits.core":12}],79:[function(e,t,i){"use strict";var n=e("./ServiceGetOnly");t.exports=n.extend({baseUrl:"/ical/feed",type:"ical_feed",getURL:function(e){var t=this;return t.get(t.baseUrl,void 0,e).promise()}})},{"./ServiceGetOnly":95}],80:[function(e,t,i){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/import",type:"import",create:function(e,t){var i=this;return i.post(i.baseUrl,e,t,3e5).promise()}})},{"./AuthenticatedService":73}],81:[function(e,t,i){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/list_positions",type:"list_position"})},{"./AuthenticatedService":73}],82:[function(e,t,i){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/list_reminders_collections",type:"list_reminders_collection"})},{"./AuthenticatedService":73}],83:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.lib.assert,s=n.WBDeferred,o=e("magiconsole"),a=new o("SDK:SERVICE:LISTS"),c=e("./Memberships"),u=e("./AuthenticatedService"),l=u.prototype;t.exports=u.extend({baseUrl:"/lists",type:"list",initialize:function(e){var t=this;l.initialize.apply(t,arguments),t.membershipsService=new c(e)},create:function(e){var t=this;try{t.validateCreateData(e)}catch(i){return a.error(i),(new s).reject({errors:[i.toString()]},0).promise()}var n=l.create.apply(t,arguments);return n.promise()},accepted:function(){var e=this,t=new s;return e.membershipsService.mine().done(function(i){var n=i.filter(function(e){return"accepted"===e.state}),r=n.map(function(e){return e.list_id});e.all().done(function(e){var i=e.filter(function(e){return r.indexOf(e.id)>-1});t.resolve(i)}).fail(t.reject,t)}).fail(t.reject,t),t.promise()},validateCreateData:function(e){e=e||{},r(e.title,"Title is required for list creation.")}})},{"./AuthenticatedService":73,"./Memberships":84,magiconsole:1,"wunderbits.core":12}],84:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.WBDeferred,s=e("./User"),o=e("./AuthenticatedService"),a=o.prototype;t.exports=o.extend({baseUrl:"/memberships",type:"membership",initialize:function(e){var t=this;a.initialize.apply(t,arguments),t.userService=new s(e)},mine:function(){var e=this,t=new r;return e.userService.all().done(function(i){e.forUser(i.id).done(t.resolve,t).fail(t.reject,t)}).fail(t.reject,t),t.promise()}})},{"./AuthenticatedService":73,"./User":107,"wunderbits.core":12}],85:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.WBMixin,s=e("../../validators/SchemaValidator");t.exports=r.extend({validateData:function(e,t){s.validateData(e,t)}})},{"../../validators/SchemaValidator":110,"wunderbits.core":12}],86:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.lib.assert,s=n.WBDeferred,o=e("magiconsole"),a=new o("SDK:SERVICE:CREATE"),c=e("./BaseServiceMixin");t.exports=c.extend({create:function(e,t){var i=this,n=e&&Object.keys(e).length;try{r(n,"Creation requires data.")}catch(o){return a.error(o),(new s).reject({errors:[o.toString()]},0).promise()}e=i.cleanCreateData(e);try{i.validateData(e,i.type)}catch(o){return a.error(o),(new s).reject({errors:[o.toString()]},0).promise()}return i.post(i.baseUrl,e,t)},cleanCreateData:function(e){for(var t in e)(null===e[t]||void 0===e[t])&&delete e[t];return e}})},{"./BaseServiceMixin":85,magiconsole:1,"wunderbits.core":12}],87:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.WBMixin,s=n.lib.assert,o=n.WBDeferred,a=e("magiconsole"),c=new a("SDK:SERVICE:DELETE"),u=e("../../helpers/URL");t.exports=r.extend({deleteID:function(e,t,i){try{s.number(e,"Deletion requires an id."),s.number(t,"Deletion requires a revision.")}catch(n){return c.error(n),(new o).reject({errors:[n.toString()]},0).promise()}var r={revision:t},a=u.compileParams(r),l=this;return l["delete"](l.baseUrl+"/"+e+a,void 0,i)}})},{"../../helpers/URL":45,magiconsole:1,"wunderbits.core":12}],88:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.WBMixin;t.exports=r.extend({getID:function(e,t){var i=this;return i.get(i.baseUrl+"/"+e,void 0,t)},getItemsForAttribute:function(e,t,i,n){var r=this,s={};return s[t]=i,r.get(e,s,n).promise()},forUser:function(e,t){var i=this;return i.getItemsForAttribute(i.baseUrl,"user_id",e,t)},forTask:function(e,t){var i=this;return i.getItemsForAttribute(i.baseUrl,"task_id",e,t)},forList:function(e,t){var i=this;return i.getItemsForAttribute(i.baseUrl,"list_id",e,t)},all:function(e){var t=this;return t.get(t.baseUrl,void 0,e).promise()},forAllLists:function(e){var t=this;return t.get(t.baseUrl+"/lists",void 0,e)},forAllTasksForList:function(e,t){var i=this;return i.getItemsForAttribute(i.baseUrl+"/tasks","list_id",e,t)}})},{"wunderbits.core":12}],89:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.lib.assert,s=n.WBDeferred,o=e("magiconsole"),a=new o("SDK:SERVICE:UPDATE"),c=e("./BaseServiceMixin");t.exports=c.extend({update:function(e,t,i,n){var o=this,c=i&&Object.keys(i).length;try{r.number(e,"Updating a resource requires an id of type number."),r.number(t,"Updating a resource requires a revision of type number."),r(c,"Updating a resource requires data to be sent.")}catch(u){return a.error(u),(new s).reject({errors:[u.toString()]},0)}return i.revision=t,o.validateData(i,o.type),i=o.prepareDataForPatch(i),o.patch(o.baseUrl+"/"+e,i,n)},prepareDataForPatch:function(e){var t,i=[];for(var n in e)t=e[n],(null===t||void 0===t)&&(i.push(n),delete e[n]);return i.length&&(e.remove=i),e}})},{"./BaseServiceMixin":85,magiconsole:1,"wunderbits.core":12}],90:[function(e,t,i){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/notes",type:"note",forList:function(e,t,i){var n=this,r=n.get(n.baseUrl,{list_id:e,completed_tasks:!!t},i);return r.promise()}})},{"./AuthenticatedService":73}],91:[function(e,t,i){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/previews",type:"preview",getPreview:function(e,t,i,n){var r=this,s={file_id:e,platform:t,size:i};return r.get(r.baseUrl,s,n)}})},{"./AuthenticatedService":73}],92:[function(e,t,i){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/reminders",type:"reminder",forList:function(e,t,i){var n=this,r=n.get(n.baseUrl,{list_id:e,completed_tasks:!!t},i);return r.promise()}})},{"./AuthenticatedService":73}],93:[function(e,t,i){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/root",type:"root"})},{"./AuthenticatedService":73}],94:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.WBEventEmitter,s=n.lib.assert,o=e("../models/ApplicationState"),a=e("../io/IO"),c=e("./Mixins/ServiceCreate"),u=e("./Mixins/ServiceDelete"),l=e("./Mixins/ServiceGet"),d=e("./Mixins/ServiceUpdate"),f=["get","post","put","patch","delete"],p=r.prototype,v=r.extend({mixins:[c,u,l,d],baseUrl:void 0,apiVersion:1,type:void 0,io:void 0,"delete":void 0,get:void 0,patch:void 0,post:void 0,put:void 0,initialize:function(e){var t=this;p.initialize.apply(t,arguments),t.options=e=e||{},t.appState=e.appState,t.checkAppState(),t.baseUrl="/v"+t.apiVersion+t.baseUrl,t.options.websocket?t.setupSocketInterfaces():t.setupRestInterfaces()},setupRestInterfaces:function(){var e,t=this;e=t.options.httpIO?t.options.httpIO:new a({config:t.appState.toJSON()});var i=t.io=e;f.forEach(function(e){t[e]=i.io[e]}),t.bindTo(t.io,"unauthorized",function(){!t.destroyed&&t.trigger("unauthorized")})},checkAppState:function(){var e=this;!e.appState&&e.options.config&&(e.appState=new o(e.options.config),e.options.appState=e.appState)},setupSocketInterfaces:function(){var e=this,t=e.options.restSocket;s(t,"No RestSocket instance available."),e.io=t,f.forEach(function(t){e[t]=e.io[t]})},destroy:function(){function e(e){for(var t in e)e[t]=void 0}var t=this;t.unbindAll(),e(t),t.destroyed=!0},destroyed:!1});t.exports=v},{"../io/IO":46,"../models/ApplicationState":54,"./Mixins/ServiceCreate":86,"./Mixins/ServiceDelete":87,"./Mixins/ServiceGet":88,"./Mixins/ServiceUpdate":89,"wunderbits.core":12}],95:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.lib.assert,s=e("./Service"),o=e("./Mixins/ServiceGet"),a=e("../io/IO"),c=function(){throw new Error("Method not allowed for this service.")};t.exports=s.extend({mixins:[o],setupRestInterfaces:function(){var e=this,t=e.io=new a({config:e.appState.toJSON()});e.get=t.io.get},setupSocketInterfaces:function(){var e=this,t=e.options.restSocket;r(t,"No RestSocket instance available."),e.io=t,e.get=e.io.get},"delete":c,patch:c,post:c,put:c})},{"../io/IO":46,"./Mixins/ServiceGet":88,"./Service":94,"wunderbits.core":12}],96:[function(e,t,i){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/services",type:"service"})},{"./AuthenticatedService":73}],97:[function(e,t,i){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/settings",type:"setting"})},{"./AuthenticatedService":73}],98:[function(e,t,i){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/subtask_positions",type:"subtask_position",forList:function(e,t,i){var n=this,r=n.get(n.baseUrl,{list_id:e,completed_tasks:!!t},i);return r.promise()}})},{"./AuthenticatedService":73}],99:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.lib.assert,s=n.WBDeferred,o=e("magiconsole"),a=new o("SDK:SERVICE:SUBTASKS"),c=e("./AuthenticatedService"),u=c.prototype;t.exports=c.extend({baseUrl:"/subtasks",type:"subtask",create:function(e){var t=this;try{t.validateCreateData(e)}catch(i){return a.error(i),(new s).reject({errors:[i.toString()]},0).promise()}var n=u.create.apply(t,arguments);return n.promise()},forList:function(e,t,i){var n=this,r=n.get(n.baseUrl,{list_id:e,completed_tasks:!!t},i);return r.promise()},validateCreateData:function(e){e=e||{};var t=Object.keys(e).length,i=" required for subtask creation";r(t,"data"+i),r.number(e.task_id,"data.task_id"+i),r.string(e.title,"data.title"+i)}})},{"./AuthenticatedService":73,magiconsole:1,"wunderbits.core":12}],100:[function(e,t,i){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/task_comments",type:"task_comment"})},{"./AuthenticatedService":73}],101:[function(e,t,i){
"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/task_comments_states",type:"task_comments_state"})},{"./AuthenticatedService":73}],102:[function(e,t,i){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/task_positions",type:"task_position"})},{"./AuthenticatedService":73}],103:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.lib.assert,s=n.WBDeferred,o=e("magiconsole"),a=new o("SDK:SERVICE:TASKS"),c=e("./AuthenticatedService"),u=c.prototype;t.exports=c.extend({baseUrl:"/tasks",type:"task",forList:function(e,t,i){var n=this,r=n.get(n.baseUrl,{list_id:e,completed:!!t},i);return r.promise()},create:function(e){var t=this;try{t.validateCreateData(e)}catch(i){return a.error(i),(new s).reject({errors:[i.toString()]},0).promise()}var n=u.create.apply(t,arguments);return n.promise()},validateCreateData:function(e){e=e||{};var t=Object.keys(e).length,i=" required for task creation";r(t,"data"+i),r.number(e.list_id,"data.list_id"+i),r.string(e.title,"data.title"+i)}})},{"./AuthenticatedService":73,magiconsole:1,"wunderbits.core":12}],104:[function(e,t,i){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/lists/tasks_count",type:"tasks_count"})},{"./AuthenticatedService":73}],105:[function(e,t,i){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/unread_activity_counts",type:"unread_activities_count"})},{"./AuthenticatedService":73}],106:[function(e,t,i){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/uploads",type:"upload",create:function(e,t){var i=this;return i.post(i.baseUrl,e,t)},getPart:function(e,t,i){var n=this,r={part_number:t};return n.get(n.baseUrl+"/"+e+"/parts",r,i)},finish:function(e,t){var i=this,n={state:"finished"};return i.patch(i.baseUrl+"/"+e,n,t)}})},{"./AuthenticatedService":73}],107:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.lib.assert,s=n.WBDeferred,o=e("magiconsole"),a=new o("SDK:SERVICE:USER"),c=e("./AuthenticatedService");t.exports=c.extend({baseUrl:"/user",type:"user",update:function(e,t,i){var n=this,o=t&&Object.keys(t).length;try{r.number(e,"Updating a user requires a revision of type number."),r(o,"Updating a user requires data to be sent.")}catch(c){return a.error(c),(new s).reject({errors:[c.toString()]},0).promise()}t.revision=e;try{n.validateData(t,n.type)}catch(c){return a.error(c),(new s).reject({errors:[c.toString()]},0)}return t=n.prepareDataForPatch(t),n.patch(n.baseUrl,t,i)},changeEmail:function(e,t,i){var n=this,r={email:e,password:t};return n.patch(n.baseUrl+"/email",r,i)},changePassword:function(e,t,i){var n=this,r={password:e,old_password:t};return n.patch(n.baseUrl+"/password",r,i)},deleteSelf:function(e,t){var i=this,n={password:e};return i["delete"](i.baseUrl,n,t)}})},{"./AuthenticatedService":73,magiconsole:1,"wunderbits.core":12}],108:[function(e,t,i){"use strict";var n=e("./AuthenticatedService");t.exports=n.extend({baseUrl:"/users",type:"user"})},{"./AuthenticatedService":73}],109:[function(e,t,i){"use strict";var n=e("./ServiceGetOnly"),r={activities:e("./Activities"),conversations:e("./Conversations"),"export":e("./Export"),features:e("./Features"),files:e("./Files"),folders:e("./Folders"),"import":e("./Import"),ical_feed:e("./IcalFeed"),list_positions:e("./ListPositions"),list_reminders_collections:e("./ListRemindersCollections"),lists:e("./Lists"),memberships:e("./Memberships"),notes:e("./Notes"),previews:e("./Previews"),reminders:e("./Reminders"),root:e("./Root"),services:e("./Services.js"),settings:e("./Settings"),subtask_positions:e("./SubtaskPositions"),subtasks:e("./Subtasks"),task_comments:e("./TaskComments"),task_comments_states:e("./TaskCommentsStates"),task_positions:e("./TaskPositions"),tasks:e("./Tasks"),tasks_counts:e("./TasksCounts"),unread_activities_counts:e("./UnreadActivitiesCounts"),uploads:e("./Uploads"),user:e("./User"),users:e("./Users")},s=["list","task"];s.forEach(function(e){var t=e+"_revisions";r[t]=n.extend({baseUrl:"/"+t,type:t})}),t.exports=r},{"./Activities":72,"./Conversations":74,"./Export":75,"./Features":76,"./Files":77,"./Folders":78,"./IcalFeed":79,"./Import":80,"./ListPositions":81,"./ListRemindersCollections":82,"./Lists":83,"./Memberships":84,"./Notes":90,"./Previews":91,"./Reminders":92,"./Root":93,"./ServiceGetOnly":95,"./Services.js":96,"./Settings":97,"./SubtaskPositions":98,"./Subtasks":99,"./TaskComments":100,"./TaskCommentsStates":101,"./TaskPositions":102,"./Tasks":103,"./TasksCounts":104,"./UnreadActivitiesCounts":105,"./Uploads":106,"./User":107,"./Users":108}],110:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.WBSingleton,s=e("magiconsole"),o=new s("SDK:SCHEMAVALIDATOR"),a=e("../schemas"),c={array:"isArray",integer:"isInteger","boolean":"isBoolean",string:"isString",ISODate:"isISODate"},u=r.extend({validateData:function(e,t){var i,n,r,s,u=this,l=!0,d=a[t];if(!d)return o.warn('No data schema for type "'+t+'"'),!0;for(var f in e)r=void 0,i=d[f],i||o.warn("No validation set for key",f,"for",t),s=e[f],n=u[c[i]],n&&(r=n.call(u,s),r||(o.warn(t+" value "+s+" ("+typeof s+') for key "'+f+'"" did not pass validation for type '+i),l=!1));return l},isArray:function(e){return Array.isArray(e)},isBoolean:function(e){return e===!1||e===!0},isInteger:function(e){return"number"==typeof e&&parseFloat(e)===parseInt(e,10)&&!isNaN(e)},isString:function(e){return"string"==typeof e},isISODate:function(e){var t=this;if(!t.isString(e))return!1;var i=/^\d{4}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-2])T(0[0-9]|1[0-9]|2[0-3])(:([0-5][0-9])){2}(\.\d{3})?Z$/;return i.test(e)}});t.exports=u},{"../schemas":71,magiconsole:1,"wunderbits.core":12}],111:[function(e,t,i){(function(i){"use strict";var n=e("wunderbits.core"),r=n.WBEventEmitter,s=e("../helpers/HealthCheck"),o=i.navigator||{onLine:!0},a=r.extend({online:null,initialize:function(e){var t=this,n=i.document;if(t.online=o.onLine,i.addEventListener)i.addEventListener("online",t.onOnline.bind(t),!1),i.addEventListener("offline",t.onOffline.bind(t),!1);else if(n){var r=n.body;r.ononline=t.isOnline,r.onoffline=t.isOffline}e.config.checkHealth&&t.bindToApiHealth(e)},destroy:function(){s.destroy()},bindToApiHealth:function(e){var t=this;s.init(e),t.bindTo(s,"healthy","onOnline"),t.bindTo(s,"unhealthy","onOffline")},isOnline:function(){return this.online},onOnline:function(){var e=this;e.online=!0,e.trigger("online")},onOffline:function(){var e=this;e.online=!1,e.trigger("offline")}});t.exports=a}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../helpers/HealthCheck":43,"wunderbits.core":12}],112:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.WBSingleton,s=e("magiconsole"),o=new s("SDK:SAFEPARSE"),a=r.extend({json:function(e){try{return JSON.parse(e)}catch(t){o.warn('Unable to parse "'+e+'"')}}});t.exports=a},{magiconsole:1,"wunderbits.core":12}],113:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.lib.functions,s=[],o=function(){return function(e){for(var t,i=arguments.length>1?s.concat.apply(s,s.slice.call(arguments,1)):r(e);i.length;)t=i.shift(),"constructor"!==t&&(e[t]=e[t].bind(e))}}();t.exports=o},{"wunderbits.core":12}],114:[function(e,t,i){"use strict";var n=e("wunderbits.core"),r=n.WBEventEmitter,s=n.WBDeferred,o=n.lib.extend,a=e("../io/io/AjaxTransport"),c=e("../config/default"),u=e("../models/ApplicationState"),l=e("../io/IO"),d=e("../io/RestSocket"),f=e("../helpers/PlatformHeaders"),p=e("../services"),v=e("magiconsole"),h=r.prototype,m=r.extend({auth:void 0,state:void 0,online:void 0,initialized:void 0,http:void 0,socket:void 0,initialize:function(e){var t=this;h.initialize.apply(t,arguments),t.options=e=o(c,e||{}),t.setupLogging(t.options),t.validateOptions(),t.appState=new u(e),f.init(e);var i=t.state=new s;t.initialized=t.state.promise(),t.online=t.appState.isOnline(),t.start().done(i.resolveWith,i,t).fail(i.reject,i)},setupLogging:function(e){e.logLevel&&v.setLevel(e.logLevel),e.logPattern&&v.setPattern(e.logPattern)},isInitialized:function(){var e=this;return!(!e.initialized||"resolved"!==e.initialized.state())},start:function(){var e,t=this;return e=t.getServices(),t.bindTo(t.appState,"change:online","onOnlineOffline"),t.bindTo(a,"timing:io","onIOTiming"),e},onOnlineOffline:function(){var e=this;e.online=e.appState.isOnline(),e.trigger(e.online?"online":"offline")},onIOTiming:function(e){var t=this;t.trigger("timing:io",e)},getServices:function(){var e,t,i,n=this,r={http:{},socket:{}},o=new s,a=n.appState.attributes.accessToken;return n.createSocket(a).done(function(){n.http=void 0,n.socket=void 0,t=t||n.options.services||Object.keys(p),n.httpIO=new l({config:n.appState.toJSON()});for(var s=0,a=t.length;a>s;s++)e=t[s],i=p[e],r.http[e]=new i({appState:n.appState,httpIO:n.httpIO}),n.bindTo(r.http[e],"unauthorized",n.onUnauthorized),r.socket[e]=new i({websocket:!0,restSocket:n.restSocket,appState:n.appState});n.http=r.http,n.socket=r.socket,o.resolve(r)}),o.promise()},isSocketOnline:function(){var e=this,t=e.restSocket,i=t&&t.socket,n=!(!i||!i.isConnected());return n},getOutlet:function(){var e=this,t=e.isSocketOnline(),i=!!e.options.forceHTTP;return t&&!i?e.socket:e.http},createSocket:function(){var e=this;e.restSocket&&e.unbindFrom(e.restSocket);var t=new d({appState:e.appState,config:e.options});return e.restSocket=t,e.bindTo(t,"event",function(t){e.trigger("event",t)}),e.bindTo(t,"desktopNotification",function(t){e.trigger("desktopNotification",t)}),e.bindTo(t,"unauthorized",e.onUnauthorized),e.bindTo(t,"timing:io","onIOTiming"),t.ready.promise()},onUnauthorized:function(){var e=this;e.trigger("unauthorized"),e.destroy()},destroy:function(){function e(e){for(var t in e)e[t]=void 0}var t=this;t.restSocket&&t.restSocket.destroy(),t.unbindAll();var i=["http","socket"];i.forEach(function(e){var i;for(var n in t[e])i=t[e][n],i.destroy&&i.destroy();t[e]=void 0}),t.appState.destroy(),e(t),t.destroyed=!0},destroyed:!1,validateOptions:function(){var e=this,t=e.options||{},i=!!t.accessToken;if(!t.clientID||!i)throw new Error("Cannot initialize the Wunderlist SDK without a Client ID or auth credentials")},cancelInflightCreate:function(e,t,i){var n=this,r=n.restSocket,s=n.httpIO;r&&r.cancelInflightCreate(e,t,i),s&&s.cancelInflightCreate(e,t,i)}},{services:p,headers:f});t.exports=m},{"../config/default":40,"../helpers/PlatformHeaders":44,"../io/IO":46,"../io/RestSocket":48,"../io/io/AjaxTransport":49,"../models/ApplicationState":54,"../services":109,magiconsole:1,"wunderbits.core":12}]},{},[114])(114)});